<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Moment demo</title>

<script src="../formula.js"></script>

<!-- the Moment functions requires momentjs -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.12.0/moment.min.js"></script>
<script src="../library/datatypes/Moment.js"></script>

<!-- InputById requires jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script src="../library/referencetypes/InputById.js"></script>

<!-- For convenience add an initializer, allowing us to specify formulas in the data-formula attribute of input fields -->
<script src="../library/initializers/data-formula-attr.js"></script>
<script>


Formula.addFunction('IF', function(test, then, otherwise) {
  return (test ? then : otherwise);
});




</script>
<style>
  body {max-width: 1200px; padding:2% 5%}
  label {margin-right: 10px; min-width: 190px; display: inline-block;}
  i {font-size: 0.9em}
  table {border-collapse: collapse}
  input {width: 140px; text-align:right; margin-right: 10px;}
</style>
</head>
<body>
<h2>Examples of MOMENT functions</h2>
<h3>Creating a moment</h3>
<p>With no arguments, MOMENT() returns current time</p>
<input data-formula="MOMENT()" readonly></input><i>MOMENT()</i><br>
<p>With two arguments, MOMENT(dateString, formatString), the first string is the date and the second is the format</p>
<input data-formula="MOMENT('2016-12-24', 'YYYY-MM-DD')" readonly></input><i>MOMENT('2016-12-24', 'YYYY-MM-DD')</i><br>
<p>The constructor thus works as a parser too. But be aware that it is a <i>very</i> lenient parser, which might not be what you need. In that case, you may find need of the utility function MOMENT_TEST_DATE_FORMAT (we will get to that)</p>

<h3>Formatting a moment</h3>
<p>For full syntax of formatting, head over here: <a href="http://momentjs.com/docs/#/displaying/">http://momentjs.com/docs/#/displaying/</a></p>
<input data-formula="MOMENT_FORMAT(MOMENT(),'DD-MM-YYYY')" readonly></input><i>MOMENT_FORMAT(MOMENT(),'DD-MM-YYYY')</i><br>
<input data-formula="MOMENT_FORMAT(MOMENT(),'Do [of] MMMM [in gods year] YYYY')" readonly></input><i>MOMENT_FORMAT(MOMENT(),'Do [of] MMMM [in gods year] YYYY')</i><br>

<h3>Getting parts of a moment</h3>
<p>The MOMENT_GET returns a unit of the moment. Available units: 'year', 'month', 'date', 'hour', 'minute', 'second', 'millisecond'</p>
<input data-formula="MOMENT_GET(MOMENT(), 'hours')" readonly></input><i>MOMENT_GET(MOMENT(), 'hours')</i><br>
<p>For convenience, we have added YEAR, MONTH and DAY as well</p>
<input data-formula="MOMENT_YEAR(MOMENT())" readonly></input><i>MOMENT_YEAR(MOMENT())</i><br>
<input data-formula="MOMENT_MONTH(MOMENT())" readonly></input><i>MOMENT_MONTH(MOMENT())</i><br>
<input data-formula="MOMENT_DATE(MOMENT())" readonly></input><i>MOMENT_DATE(MOMENT())</i><br>

<h3>Adding units to a moment</h3>
<p>Here, we add 1 day to current date, and format it</p>
<input data-formula="MOMENT_FORMAT(MOMENT_ADD(MOMENT(), 1, 'days'), 'DD MMM YYYY')" readonly></input><i>MOMENT_FORMAT(MOMENT_ADD(MOMENT(), 1, 'days'), 'DD MMM YYYY')</i><br>

<h3>Stricter parsing</h3>
<p>MOMENT_TEST_DATE_FORMAT(text, pattern) tests more strictly whether a date string complies to a pattern.
These will return boolean true:</p>
MOMENT_TEST_DATE_FORMAT('12-24-2014', 'MM-DD-YYYY') <br>
MOMENT_TEST_DATE_FORMAT('2/14-2014', 'M/D-YYYY') <br>
MOMENT_TEST_DATE_FORMAT('banana 2/24 2014', 'banana M/DD YYYY')<br>
<p>This will return false:</p>
MOMENT_TEST_DATE_FORMAT('2/14-2014', 'M-D-YYYY') <br>
<p>Note: ONLY the following tokens are supported: MM, DD, YYYY, D, M</p>

Test this date string: <input id="parse_date" value="12-24-2018"></input><br>
against this format:  <input id="parse_format" value="MM-DD-YYYY"></input><br>
Result: <input data-formula="IF(MOMENT_TEST_DATE_FORMAT(#parse_date, #parse_format), 'ok', 'not ok')" readonly></input><i></i><br>
Result as date: <input data-formula="IF(MOMENT_TEST_DATE_FORMAT(#parse_date, #parse_format), MOMENT_FORMAT(MOMENT(#parse_date, #parse_format), 'DD MMM YYYY'), 'whopsie - not a wellformatted date')" readonly></input><i></i><br>
<!--<input data-formula="MOMENT_FORMAT(MOMENT_STRICT_PARSE(#parse_date, #parse_format), 'DD MMM YYYY')" readonly></input><i></i><br>-->




<h3>Not more?</h3>
momentjs has much more functionality than utilized by the few functions we have added here. You are very welcome to help adding more functions.

</body>
</html>
